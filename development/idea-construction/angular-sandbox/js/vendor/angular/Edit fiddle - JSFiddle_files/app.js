(function(){var t,e,s=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function s(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},o={}.hasOwnProperty;e=function(){function t(){}return t.prototype.pushMessage=function(t,e){return null==e&&(e={}),window.parent.postMessage([t,e],"*")},t.prototype.extend=function(t,e){var s;if(e)for(s in e)e[s]&&e[s].constructor&&e[s].constructor===Object?(t[s]=t[s]||{},arguments.callee(t[s],e[s])):t[s]=e[s];return t},t.prototype.addEvent=function(t,e,s,n){return null==n&&(n=!1),t.addEventListener(e,s,n)},t.prototype.setStyles=function(t,e){var s,n;n=[];for(s in e)n.push(t.style[s]=e[s]);return n},t}(),t=function(t){function e(){this.setDetailsHeight=s(this.setDetailsHeight,this),this.setListHeight=s(this.setListHeight,this),this.markReadItems=s(this.markReadItems,this),this.countUnreadItems=s(this.countUnreadItems,this),this.countAllItems=s(this.countAllItems,this),this.getReadIds=s(this.getReadIds,this),this.setReadIds=s(this.setReadIds,this);var t,e,n,o;for(this.elements={logItems:document.querySelectorAll(".logItem"),backLinks:document.querySelectorAll(".back"),logListCont:document.querySelector(".logListCont"),logDetailsItem:document.querySelectorAll(".logDetailsItem"),innercont:document.querySelector(".innercont")},this.elements.logItems=Array.prototype.slice.call(this.elements.logItems,0),this.currentCount=this.countUnreadItems(),this.readIds=this.getReadIds(),this.markReadItems(),this.elements.logItems.forEach(function(t){return function(e,s,n){return t.addEvent(e,"click",function(n){return n.stopPropagation(),n.preventDefault(),t.moveScreenTo(-300),t.setDetailsHeight(s),t.currentCount>=0&&!e.dataset.read&&t.readIds.indexOf(e.dataset.id)<0&&(t.currentCount=t.currentCount-1,t.setReadIds(e.dataset.id),t.markReadItems()),t.pushMessage("setBadge",{counter:t.currentCount,softHide:!0})})}}(this)),o=this.elements.backLinks,t=0,e=o.length;e>t;t++)n=o[t],this.addEvent(n,"click",function(t){return function(e){return e.stopPropagation(),e.preventDefault(),t.moveScreenTo(0),t.setListHeight()}}(this));this.setListHeight(),this.pushMessage("widgetReady",{counter:this.currentCount,softHide:!0}),window.addEventListener("message",function(t){return function(e){var s;return s=e.data[0],"restore"===s?(t.moveScreenTo(0),t.setListHeight()):void 0}}(this),!1)}return n(e,t),e.prototype.setReadIds=function(t){var e;return this.readIds.push(t),e=this.readIds.join(","),window.localStorage.setItem("HW_readItems",e)},e.prototype.getReadIds=function(){var t;return t=window.localStorage.HW_readItems,t=t?null!=t?t.split(","):void 0:[]},e.prototype.countAllItems=function(){return this.elements.logItems.length},e.prototype.countUnreadItems=function(){return this.countAllItems()-this.getReadIds().length},e.prototype.markReadItems=function(){var t,e,s,n,o,r;if(this.getReadIds().length>0){for(o=this.getReadIds(),r=[],t=0,n=o.length;n>t;t++)e=o[t],s=document.querySelector("*[data-id="+e+"]"),r.push(null!=s?s.dataset.read=!0:void 0);return r}},e.prototype.setListHeight=function(){return this.pushMessage("setHeight",{height:this.elements.logListCont.offsetHeight})},e.prototype.setDetailsHeight=function(t){var e,s,n,o;for(o=this.elements.logDetailsItem,e=0,n=o.length;n>e;e++)s=o[e],this.setStyles(s,{display:"none"});return this.setStyles(this.elements.logDetailsItem[t],{display:"block"}),this.pushMessage("setHeight",{height:this.elements.logDetailsItem[t].offsetHeight})},e.prototype.moveScreenTo=function(t){return this.setStyles(this.elements.innercont,{left:t+"px"})},e}(e),document.addEventListener("DOMContentLoaded",function(){return new t},!1)}).call(this);